<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.10.1">
<meta name="crystal_docs.project_version" content="main">
<meta name="crystal_docs.project_name" content="json-serializable-fake">



<link href="../css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../js/doc.js"></script>

  <meta name="repository-name" content="json-serializable-fake">
  <title>JSON::Serializable - json-serializable-fake main</title>
  <script type="text/javascript">
    CrystalDocs.base_path = "../";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="../index.html">
          json-serializable-fake
        </a>
      </h1>

      <span class="project-version">
        main
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent open current" data-id="json-serializable-fake/JSON" data-name="json">
      <a href="../JSON.html">JSON</a>
      
        <ul>
  
  <li class="parent open current" data-id="json-serializable-fake/JSON/Serializable" data-name="json::serializable">
      <a href="../JSON/Serializable.html">Serializable</a>
      
        <ul>
  
  <li class=" " data-id="json-serializable-fake/JSON/Serializable/Fake" data-name="json::serializable::fake">
      <a href="../JSON/Serializable/Fake.html">Fake</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1 class="type-name">

  <span class="kind">module</span> JSON::<wbr>Serializable

</h1>





  <h2>
    <a id="overview" class="anchor" href="#overview">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Overview
  </h2>

  <p>The <code><a href="../JSON/Serializable.html">JSON::Serializable</a></code> module automatically generates methods for JSON serialization when included.</p>
<h3><a id="example" class="anchor" href="#example">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Example</h3>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

<span class="k">class</span> <span class="t">Location</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>

  @[<span class="t">JSON</span><span class="t">::</span><span class="t">Field</span>(key: <span class="s">&quot;lat&quot;</span>)]
  property latitude : <span class="t">Float64</span>

  @[<span class="t">JSON</span><span class="t">::</span><span class="t">Field</span>(key: <span class="s">&quot;lng&quot;</span>)]
  property longitude : <span class="t">Float64</span>
<span class="k">end</span>

<span class="k">class</span> <span class="t">House</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  property address : <span class="t">String</span>
  property location : <span class="t">Location</span>?
<span class="k">end</span>

house <span class="o">=</span> <span class="t">House</span>.from_json(<span class="s">%({&quot;address&quot;: &quot;Crystal Road 1234&quot;, &quot;location&quot;: {&quot;lat&quot;: 12.3, &quot;lng&quot;: 34.5}})</span>)
house.address  <span class="c"># =&gt; &quot;Crystal Road 1234&quot;</span>
house.location <span class="c"># =&gt; #&lt;Location:0x10cd93d80 @latitude=12.3, @longitude=34.5&gt;</span>
house.to_json  <span class="c"># =&gt; %({&quot;address&quot;:&quot;Crystal Road 1234&quot;,&quot;location&quot;:{&quot;lat&quot;:12.3,&quot;lng&quot;:34.5}})</span>

houses <span class="o">=</span> <span class="t">Array</span>(<span class="t">House</span>).from_json(<span class="s">%([{&quot;address&quot;: &quot;Crystal Road 1234&quot;, &quot;location&quot;: {&quot;lat&quot;: 12.3, &quot;lng&quot;: 34.5}}])</span>)
houses.size    <span class="c"># =&gt; 1</span>
houses.to_json <span class="c"># =&gt; %([{&quot;address&quot;:&quot;Crystal Road 1234&quot;,&quot;location&quot;:{&quot;lat&quot;:12.3,&quot;lng&quot;:34.5}}])</span></code></pre>
<h3><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h3>
<p>Including <code><a href="../JSON/Serializable.html">JSON::Serializable</a></code> will create <code>#to_json</code> and <code>self.from_json</code> methods on the current class,
and a constructor which takes a <code>JSON::PullParser</code>. By default, these methods serialize into a json
object containing the value of every instance variable, the keys being the instance variable name.
Most primitives and collections supported as instance variable values (string, integer, array, hash, etc.),
along with objects which define to_json and a constructor taking a <code>JSON::PullParser</code>.
Union types are also supported, including unions with nil. If multiple types in a union parse correctly,
it is undefined which one will be chosen.</p>
<p>To change how individual instance variables are parsed and serialized, the annotation <code>JSON::Field</code>
can be placed on the instance variable. Annotating property, getter and setter macros is also allowed.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

<span class="k">class</span> <span class="t">A</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>

  @[<span class="t">JSON</span><span class="t">::</span><span class="t">Field</span>(key: <span class="s">&quot;my_key&quot;</span>, emit_null: <span class="n">true</span>)]
  getter a : <span class="t">Int32</span>?
<span class="k">end</span></code></pre>
<p><code>JSON::Field</code> properties:</p>
<ul>
<li><strong>ignore</strong>: if <code>true</code> skip this field in serialization and deserialization (by default false)</li>
<li><strong>ignore_serialize</strong>: If truthy, skip this field in serialization (default: <code>false</code>). The value can be any Crystal expression and is evaluated at runtime.</li>
<li><strong>ignore_deserialize</strong>: if <code>true</code> skip this field in deserialization (by default false)</li>
<li><strong>key</strong>: the value of the key in the json object (by default the name of the instance variable)</li>
<li><strong>root</strong>: assume the value is inside a JSON object with a given key (see <code>Object.from_json(string_or_io, root)</code>)</li>
<li><strong>converter</strong>: specify an alternate type for parsing and generation. The converter must define <code>from_json(JSON::PullParser)</code> and <code>to_json(value, JSON::Builder)</code>. Examples of converters are a <code>Time::Format</code> instance and <code>Time::EpochConverter</code> for <code>Time</code>.</li>
<li><strong>presence</strong>: if <code>true</code>, a <code>@{{key}}_present</code> instance variable will be generated when the key was present (even if it has a <code>null</code> value), <code>false</code> by default</li>
<li><strong>emit_null</strong>: if <code>true</code>, emits a <code>null</code> value for nilable property (by default nulls are not emitted)</li>
</ul>
<p>Deserialization also respects default values of variables:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

<span class="k">struct</span> <span class="t">A</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  @a : <span class="t">Int32</span>
  @b : <span class="t">Float64</span> <span class="o">=</span> <span class="n">1.0</span>
<span class="k">end</span>

<span class="t">A</span>.from_json(<span class="s">%&lt;{&quot;a&quot;:1}&gt;</span>) <span class="c"># =&gt; A(@a=1, @b=1.0)</span></code></pre>
<h3><a id="extensions-jsonserializablestrict-and-jsonserializableunmapped." class="anchor" href="#extensions-jsonserializablestrict-and-jsonserializableunmapped.">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Extensions: <code>JSON::Serializable::Strict</code> and <code>JSON::Serializable::Unmapped</code>.</h3>
<p>If the <code>JSON::Serializable::Strict</code> module is included, unknown properties in the JSON
document will raise a parse exception. By default the unknown properties
are silently ignored.
If the <code>JSON::Serializable::Unmapped</code> module is included, unknown properties in the JSON
document will be stored in a <code>Hash(String, JSON::Any)</code>. On serialization, any keys inside json_unmapped
will be serialized and appended to the current json object.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

<span class="k">struct</span> <span class="t">A</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span><span class="t">::</span><span class="t">Unmapped</span>
  @a : <span class="t">Int32</span>
<span class="k">end</span>

a <span class="o">=</span> <span class="t">A</span>.from_json(<span class="s">%({&quot;a&quot;:1,&quot;b&quot;:2})</span>) <span class="c"># =&gt; A(@json_unmapped={&quot;b&quot; =&gt; 2}, @a=1)</span>
a.json_unmapped[<span class="s">&quot;b&quot;</span>].raw.<span class="k">class</span>    <span class="c"># =&gt; Int64</span>
a.to_json                         <span class="c"># =&gt; %({&quot;a&quot;:1,&quot;b&quot;:2})</span></code></pre>
<h3><a id="class-annotation-jsonserializableoptions" class="anchor" href="#class-annotation-jsonserializableoptions">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Class annotation <code>JSON::Serializable::Options</code></h3>
<p>supported properties:</p>
<ul>
<li><strong>emit_nulls</strong>: if <code>true</code>, emits a <code>null</code> value for all nilable properties (by default nulls are not emitted)</li>
</ul>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

@[<span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span><span class="t">::</span><span class="t">Options</span>(emit_nulls: <span class="n">true</span>)]
<span class="k">class</span> <span class="t">A</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  @a : <span class="t">Int32</span>?
<span class="k">end</span></code></pre>
<h3><a id="discriminator-field" class="anchor" href="#discriminator-field">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Discriminator field</h3>
<p>A very common JSON serialization strategy for handling different objects
under a same hierarchy is to use a discriminator field. For example in
<a href="https://tools.ietf.org/html/rfc7946">GeoJSON</a> each object has a &quot;type&quot;
field, and the rest of the fields, and their meaning, depend on its value.</p>
<p>You can use <code>JSON::Serializable.use_json_discriminator</code> for this use case.</p>
<h3><a id="after-initialize-method" class="anchor" href="#after-initialize-method">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>after_initialize</code> method</h3>
<p><code>#after_initialize</code> is a method that runs after an instance is deserialized
from JSON. It can be used as a hook to post-process the initialized object.</p>
<p>Example:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;json&quot;</span>

<span class="k">class</span> <span class="t">Person</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  getter name : <span class="t">String</span>

  <span class="k">def</span> <span class="m">after_initialize</span>
    @name <span class="o">=</span> @name.upcase
  <span class="k">end</span>
<span class="k">end</span>

person <span class="o">=</span> <span class="t">Person</span>.from_json <span class="s">%({&quot;name&quot;: &quot;Jane&quot;})</span>
person.name <span class="c"># =&gt; &quot;JANE&quot;</span></code></pre>














  <h2>
    <a id="defined-in" class="anchor" href="#defined-in">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Defined in:
  </h2>
  
    
      <a href="https://github.com/ryan-kraay/json-serializable-fake/blob/4d5f13fc41af780ac50191802b0e82664a93e642/src/json-serializable-fake.cr#L7" target="_blank">
        json-serializable-fake.cr
      </a>
    
    <br/>
  













<div class="methods-inherited">
  
</div>









</div>

</body>
</html>
